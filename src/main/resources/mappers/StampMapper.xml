<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mountain.doo.repository.StampMapper">

    <select id="stampCount" resultType="Stamp">
        SELECT account_id,attend_count,board_count,banner_click_count,current_stamp_count,total_stamp_count
        FROM stamp
        WHERE account_id = #{accountId}

    </select>

<!--    배너 +1 시키는 쿼리-->
    <update id="bannerPlus">
        UPDATE stamp
        SET banner_click_count = banner_click_count+1
        WHERE account_id = #{accountId}
    </update>

<!--    게시판 작성시 +1-->
    <update id="boardPlus">
        UPDATE stamp
        SET board_count = board_count+1
        WHERE account_id = #{accountId}
    </update>

<!--    내가 쓴 게시물 찾기-->
    <select id="myBoard" resultType="int">
        SELECT count(*)
        FROM offer AS b1
        JOIN feed AS b2 ON b1.account_id = b2.account_id
        JOIN review AS b3 ON b1.account_id = b3.account_id
        JOIN issue AS b4 ON b1.account_id = b4.account_id
        JOIN club AS b5 ON b1.account_id = b5.account_id
        JOIN secondhand AS b6 ON b1.account_id = b6.account_id
        WHERE b1.account_id = #{accountId}
    </select>


<!-- 스탬프 개수 1-->

    <update id="stampAdd">
        UPDATE stamp
        SET total_stamp_count=total_stamp_count+1
        WHERE account_id = #{accountId}
    </update>

<!--    현재 스탬프개수 +1-->
    <update id="currentAdd">
        UPDATE stamp
        SET current_stamp_count=current_stamp_count+1
        WHERE account_id = #{accountId}
    </update>

    <!--    현재 스탬스개수 count-->
    <select id="currentCount" resultType="int">
        SELECT current_stamp_count
        from stamp
        WHERE account_id = #{accountId}

    </select>

<!--    응모권사용 현재 스탬프 -18-->
    <update id="openEvent">
        UPDATE stamp
        SET current_stamp_count = current_stamp_count-18
        WHERE account_id = #{accountId}
    </update>

    <select id="myBoard" resultType="int">
        select count(board_no)
        from stamp
        inner join feed on stamp.account_id = feed.account_id
    </select>


</mapper>
